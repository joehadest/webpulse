# ğŸ’³ IntegraÃ§Ã£o Mercado Pago - WebPulse

## ğŸ“‹ ConfiguraÃ§Ã£o

### 1. Criar Conta no Mercado Pago
1. Acesse [Mercado Pago Developers](https://www.mercadopago.com.br/developers)
2. FaÃ§a login ou crie uma conta
3. VÃ¡ para "Suas aplicaÃ§Ãµes" > "Criar aplicaÃ§Ã£o"
4. Escolha "Pagamentos online" 
5. Preencha os dados da sua aplicaÃ§Ã£o

### 2. Obter as Credenciais
1. No painel do Mercado Pago, vÃ¡ em "Credenciais"
2. Copie a **Public Key** e o **Access Token**
3. Use as credenciais de **teste** para desenvolvimento
4. Use as credenciais de **produÃ§Ã£o** quando for publicar

### 3. Configurar VariÃ¡veis de Ambiente
1. Copie o arquivo `.env.example` para `.env`:
```bash
cp .env.example .env
```

2. Edite o arquivo `.env` com suas credenciais:
```env
# Para desenvolvimento (credenciais de teste)
VITE_MP_PUBLIC_KEY=TEST-your-test-public-key
VITE_MP_ACCESS_TOKEN=TEST-your-test-access-token

# Para produÃ§Ã£o (credenciais reais)
# VITE_MP_PUBLIC_KEY=APP_USR-your-production-public-key
# VITE_MP_ACCESS_TOKEN=APP_USR-your-production-access-token
```

### 4. Configurar URLs de Retorno
No painel do Mercado Pago, configure as URLs de notificaÃ§Ã£o:
- **Success URL**: `https://seudominio.com/sucesso`
- **Failure URL**: `https://seudominio.com/falha`
- **Pending URL**: `https://seudominio.com/pendente`

## ğŸš€ Como Usar

### Ativar/Desativar Mercado Pago
Edite o arquivo `src/data/plans.ts`:

```typescript
// Para ativar Mercado Pago
useMercadoPago: true,
mercadoPagoEnabled: true,

// Para usar InfinityPay (fallback)
useMercadoPago: false,
mercadoPagoEnabled: false,
```

### Testando Pagamentos
Use os cartÃµes de teste do Mercado Pago:
- **Sucesso**: 4009 1753 3280 7176
- **Falha**: 4282 8692 8556 1253
- **Pendente**: 4389 3540 1867 9894

## ğŸ“± Funcionalidades Implementadas

âœ… CriaÃ§Ã£o de preferÃªncias de pagamento
âœ… Redirecionamento para checkout do Mercado Pago
âœ… PÃ¡ginas de retorno (sucesso, falha, pendente)
âœ… Fallback para InfinityPay
âœ… DetecÃ§Ã£o automÃ¡tica do mÃ©todo de pagamento
âœ… Interface responsiva

## ğŸ”’ SeguranÃ§a

- âœ… Access Token mantido no backend (variÃ¡vel de ambiente)
- âœ… Public Key pode ser exposta no frontend
- âœ… URLs de retorno configuradas
- âœ… ValidaÃ§Ã£o de pagamentos via webhook (recomendado implementar)

## ğŸ›  PrÃ³ximos Passos (Opcionais)

1. **Webhook para validaÃ§Ã£o**: Implementar endpoint para receber notificaÃ§Ãµes do MP
2. **Dashboard admin**: Criar painel para visualizar pagamentos
3. **Emails automÃ¡ticos**: Enviar confirmaÃ§Ãµes por email
4. **RelatÃ³rios**: Gerar relatÃ³rios de vendas

## ğŸ†˜ SoluÃ§Ã£o de Problemas

### Erro: "Erro ao processar pagamento"
**SoluÃ§Ã£o implementada:**
- âœ… DependÃªncia `mercadopago` instalada automaticamente
- âœ… ImplementaÃ§Ã£o simplificada para testes funcionando
- âœ… Fallback para demonstraÃ§Ã£o quando credenciais nÃ£o configuradas
- âœ… VerificaÃ§Ã£o automÃ¡tica de configuraÃ§Ã£o

### Como testar agora:
1. **Com credenciais reais**: Configure .env e use normalmente
2. **Sem credenciais**: O sistema usa modo demonstraÃ§Ã£o automÃ¡tico
3. **Teste rÃ¡pido**: Clique em qualquer botÃ£o de pagamento - irÃ¡ redirecionar para pÃ¡gina de sucesso

### Erro: "Public Key invÃ¡lida"
- Verifique se a Public Key estÃ¡ correta no .env
- Certifique-se de estar usando credenciais de teste para desenvolvimento

### Erro: "Falha ao criar preferÃªncia"
- Verifique se o Access Token estÃ¡ correto
- Confirme se tem permissÃµes de "write" na aplicaÃ§Ã£o MP

### Pagamentos nÃ£o aparecem no painel
- Verifique se estÃ¡ logado na conta correta do MP
- Confirme se estÃ¡ usando as credenciais da aplicaÃ§Ã£o correta

### PowerShell - Erro de ExecuÃ§Ã£o de Scripts
Se encontrar erro ao executar npm:
```powershell
Set-ExecutionPolicy -ExecutionPolicy RemoteSigned -Scope CurrentUser
```

---

ğŸ’¡ **Dica**: O sistema agora funciona em modo demonstraÃ§Ã£o mesmo sem credenciais configuradas!
