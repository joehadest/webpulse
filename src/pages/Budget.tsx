import { useState } from 'react';

const Budget = () => {
    const [formData, setFormData] = useState({
        name: '',
        email: '',
        phone: '',
        category: '',
        service: '',
        description: '',
    });
    const [loading, setLoading] = useState(false);
    const [acceptedTerm, setAcceptedTerm] = useState(false);
    const [cpfCnpj, setCpfCnpj] = useState('');
    const [cpfCnpjError, setCpfCnpjError] = useState('');

    const categories = {
        institutional: {
            name: 'Site Institucional',
            description: 'Sites profissionais para empresas, apresentando sua marca, servi√ßos e hist√≥ria.',
            priceRange: 'R$ 3.500 - R$ 25.000',
            icon: 'üè¢',
            services: [
                {
                    name: 'Landing Page',
                    price: 'R$ 3.500 - R$ 8.000',
                    description: 'P√°gina √∫nica focada em convers√£o, ideal para campanhas espec√≠ficas, lan√ßamentos ou servi√ßos principais. Inclui formul√°rio de contato, se√ß√µes otimizadas e design responsivo.'
                },
                {
                    name: 'Site Institucional Completo',
                    price: 'R$ 8.000 - R$ 25.000',
                    description: 'Site completo com m√∫ltiplas p√°ginas, incluindo: p√°gina inicial, sobre, servi√ßos, portf√≥lio, blog e contato. Ideal para empresas que precisam de uma presen√ßa digital robusta.'
                },
                {
                    name: 'Site Corporativo',
                    price: 'R$ 12.000 - R$ 25.000',
                    description: 'Solu√ß√£o completa para grandes empresas, com √°rea administrativa, gest√£o de conte√∫do, m√∫ltiplos idiomas, integra√ß√£o com CRM e sistemas internos.'
                },
                {
                    name: 'Site One Page',
                    price: 'R$ 5.000 - R$ 10.000',
                    description: 'Site em p√°gina √∫nica com rolagem suave, ideal para pequenas empresas ou profissionais liberais. Inclui todas as se√ß√µes essenciais em uma √∫nica p√°gina.'
                }
            ]
        },
        restaurant: {
            name: 'Site para Restaurantes',
            description: 'Sites especializados para restaurantes, com card√°pio digital, reservas e delivery.',
            priceRange: 'R$ 2.500 - R$ 10.000',
            icon: 'üçΩÔ∏è',
            services: [
                {
                    name: 'Card√°pio Digital',
                    price: 'R$ 2.500 - R$ 5.000',
                    description: 'Sistema de card√°pio digital com categorias, fotos dos pratos, pre√ßos e descri√ß√µes. Inclui painel administrativo para atualiza√ß√µes r√°pidas.'
                },
                {
                    name: 'Sistema de Reservas',
                    price: 'R$ 3.500 - R$ 7.000',
                    description: 'Sistema completo de reservas online com confirma√ß√£o por email/SMS, gest√£o de mesas, hor√°rios e capacidade do restaurante.'
                },
                {
                    name: 'Integra√ß√£o com Delivery',
                    price: 'R$ 3.000 - R$ 6.000',
                    description: 'Integra√ß√£o com principais apps de delivery (iFood, Uber Eats, etc.) e sistema pr√≥prio de pedidos online com gest√£o de entregas.'
                },
                {
                    name: 'Site Completo para Restaurante',
                    price: 'R$ 5.000 - R$ 10.000',
                    description: 'Solu√ß√£o completa incluindo site institucional, card√°pio digital, sistema de reservas, integra√ß√£o com delivery e √°rea administrativa.'
                }
            ]
        },
        ecommerce: {
            name: 'E-commerce',
            description: 'Lojas virtuais completas com gest√£o de produtos, pagamentos e entregas.',
            priceRange: 'R$ 5.000 - R$ 50.000',
            icon: 'üõçÔ∏è',
            services: [
                {
                    name: 'Loja Virtual B√°sica',
                    price: 'R$ 5.000 - R$ 15.000',
                    description: 'Loja virtual com cat√°logo de produtos, carrinho de compras, checkout e integra√ß√£o com principais gateways de pagamento.'
                },
                {
                    name: 'E-commerce Completo',
                    price: 'R$ 15.000 - R$ 50.000',
                    description: 'Solu√ß√£o completa com gest√£o de estoque, m√∫ltiplos vendedores, sistema de afiliados, relat√≥rios avan√ßados e integra√ß√£o com marketplaces.'
                },
                {
                    name: 'Marketplace',
                    price: 'R$ 25.000 - R$ 50.000',
                    description: 'Plataforma completa de marketplace com gest√£o de m√∫ltiplos vendedores, sistema de comiss√µes, avalia√ß√µes e relat√≥rios detalhados.'
                },
                {
                    name: 'Integra√ß√£o com Marketplaces',
                    price: 'R$ 8.000 - R$ 20.000',
                    description: 'Integra√ß√£o com principais marketplaces (Mercado Livre, Amazon, etc.) incluindo sincroniza√ß√£o de produtos, estoque e pedidos.'
                }
            ]
        },
        blog: {
            name: 'Blogs e Portais',
            description: 'Plataformas de conte√∫do com gest√£o de posts, categorias e coment√°rios.',
            priceRange: 'R$ 3.000 - R$ 20.000',
            icon: 'üìù',
            services: [
                {
                    name: 'Blog Pessoal',
                    price: 'R$ 3.000 - R$ 8.000',
                    description: 'Blog pessoal com sistema de posts, categorias, coment√°rios e integra√ß√£o com redes sociais. Ideal para profissionais e influenciadores.'
                },
                {
                    name: 'Portal de Not√≠cias',
                    price: 'R$ 10.000 - R$ 20.000',
                    description: 'Portal completo com sistema de assinaturas, √°rea de membros, newsletter, gest√£o de redatores e monetiza√ß√£o por an√∫ncios.'
                },
                {
                    name: 'Blog Corporativo',
                    price: 'R$ 5.000 - R$ 15.000',
                    description: 'Blog integrado ao site institucional com gest√£o de conte√∫do, SEO otimizado e ferramentas de an√°lise de engajamento.'
                },
                {
                    name: 'Plataforma de Conte√∫do',
                    price: 'R$ 8.000 - R$ 20.000',
                    description: 'Plataforma completa para cria√ß√£o e distribui√ß√£o de conte√∫do, com sistema de assinaturas, cursos online e √°rea de membros.'
                }
            ]
        }
    };

    function validateCpfCnpj(value: string) {
        // Remove tudo que n√£o for n√∫mero
        const v = value.replace(/\D/g, '');
        if (v.length === 11) return true; // CPF simples
        if (v.length === 14) return true; // CNPJ simples
        return false;
    }

    const handleSubmit = (e: React.FormEvent) => {
        e.preventDefault();
        if (!validateCpfCnpj(cpfCnpj)) {
            setCpfCnpjError('Digite um CPF ou CNPJ v√°lido.');
            setLoading(false);
            return;
        }
        setLoading(true);
        const msg =
            `Ol√°! Gostaria de solicitar um or√ßamento.\n` +
            `Nome: ${formData.name}\n` +
            `Email: ${formData.email}\n` +
            `Telefone: ${formData.phone}\n` +
            `CPF/CNPJ: ${cpfCnpj}\n` +
            `Categoria: ${formData.category}\n` +
            `Servi√ßo: ${formData.service}\n` +
            `Descri√ß√£o: ${formData.description}`;
        const url = `https://wa.me/558498699449?text=${encodeURIComponent(msg)}`;
        window.open(url, '_blank');
        setLoading(false);
    };

    const handleChange = (e: React.ChangeEvent<HTMLInputElement | HTMLTextAreaElement | HTMLSelectElement>) => {
        const { name, value } = e.target;
        setFormData(prev => ({
            ...prev,
            [name]: value,
            ...(name === 'category' ? { service: '' } : {})
        }));
    };

    const handleTermChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        setAcceptedTerm(e.target.checked);
    };

    const handleCpfCnpjChange = (e: React.ChangeEvent<HTMLInputElement>) => {
        setCpfCnpj(e.target.value);
        setCpfCnpjError('');
    };

    return (
        <div className="min-h-screen bg-gradient-to-br from-gray-900 via-gray-800 to-gray-900 py-12 px-4 sm:px-6 lg:px-8">
            <div className="max-w-4xl mx-auto">
                <div className="text-center mb-12 animate-fade-in">
                    <h1 className="text-5xl font-bold text-transparent bg-clip-text bg-gradient-to-r from-red-500 to-red-600 mb-4">
                        Solicite um Or√ßamento
                    </h1>
                    <p className="text-xl text-gray-300 max-w-2xl mx-auto">
                        Transforme sua ideia em realidade com solu√ß√µes digitais personalizadas
                    </p>
                    <div className="mt-6 inline-block px-4 py-2 bg-gray-800 rounded-full border border-gray-700">
                        <p className="text-sm text-gray-400">
                            Valores estimados: <span className="text-red-500 font-medium">R$ 2.500 - R$ 50.000</span>
                        </p>
                    </div>
                </div>

                <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                    {/* Categorias */}
                    <div className="space-y-4">
                        <h2 className="text-2xl font-bold text-gray-300 mb-6">Escolha seu Projeto</h2>
                        {Object.entries(categories).map(([key, category]) => (
                            <div
                                key={key}
                                className={`p-6 rounded-xl transition-all duration-300 cursor-pointer transform hover:scale-105 ${formData.category === key
                                    ? 'bg-red-600 border-red-500'
                                    : 'bg-gray-800 border-gray-700 hover:border-red-500'
                                    } border-2`}
                                onClick={() => handleChange({ target: { name: 'category', value: key } } as any)}
                            >
                                <div className="flex items-center space-x-4">
                                    <span className="text-3xl">{category.icon}</span>
                                    <div>
                                        <h3 className={`text-lg font-semibold ${formData.category === key ? 'text-white' : 'text-gray-300'
                                            }`}>
                                            {category.name}
                                        </h3>
                                        <p className={`text-sm ${formData.category === key ? 'text-gray-200' : 'text-gray-400'
                                            }`}>
                                            {category.priceRange}
                                        </p>
                                    </div>
                                </div>
                            </div>
                        ))}
                    </div>

                    {/* Formul√°rio */}
                    <div className="bg-gray-800 rounded-xl shadow-2xl p-8 border border-gray-700">
                        <form onSubmit={handleSubmit} className="space-y-6">
                            <div className="grid grid-cols-1 gap-6">
                                <div>
                                    <label htmlFor="name" className="block text-sm font-medium text-gray-300">
                                        Nome Completo
                                    </label>
                                    <input
                                        type="text"
                                        name="name"
                                        id="name"
                                        required
                                        value={formData.name}
                                        onChange={handleChange}
                                        className="mt-1 block w-full rounded-lg bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-red-500 focus:ring-red-500 transition-colors duration-200"
                                    />
                                </div>

                                <div>
                                    <label htmlFor="email" className="block text-sm font-medium text-gray-300">
                                        Email
                                    </label>
                                    <input
                                        type="email"
                                        name="email"
                                        id="email"
                                        required
                                        value={formData.email}
                                        onChange={handleChange}
                                        className="mt-1 block w-full rounded-lg bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-red-500 focus:ring-red-500 transition-colors duration-200"
                                    />
                                </div>

                                <div>
                                    <label htmlFor="phone" className="block text-sm font-medium text-gray-300">
                                        Telefone
                                    </label>
                                    <input
                                        type="tel"
                                        name="phone"
                                        id="phone"
                                        required
                                        value={formData.phone}
                                        onChange={handleChange}
                                        className="mt-1 block w-full rounded-lg bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-red-500 focus:ring-red-500 transition-colors duration-200"
                                    />
                                </div>

                                <div>
                                    <label htmlFor="cpfCnpj" className="block text-sm font-medium text-gray-300">
                                        CPF ou CNPJ
                                    </label>
                                    <input
                                        type="text"
                                        name="cpfCnpj"
                                        id="cpfCnpj"
                                        required
                                        value={cpfCnpj}
                                        onChange={handleCpfCnpjChange}
                                        className="mt-1 block w-full rounded-lg bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-red-500 focus:ring-red-500 transition-colors duration-200"
                                        placeholder="Digite seu CPF ou CNPJ"
                                    />
                                    {cpfCnpjError && (
                                        <span className="text-red-400 text-xs">{cpfCnpjError}</span>
                                    )}
                                </div>

                                {formData.category && (
                                    <div>
                                        <label htmlFor="service" className="block text-sm font-medium text-gray-300">
                                            Servi√ßo Espec√≠fico
                                        </label>
                                        <select
                                            name="service"
                                            id="service"
                                            required
                                            value={formData.service}
                                            onChange={handleChange}
                                            className="mt-1 block w-full rounded-lg bg-gray-700 border-gray-600 text-white focus:border-red-500 focus:ring-red-500 transition-colors duration-200"
                                        >
                                            <option value="">Selecione um servi√ßo</option>
                                            {categories[formData.category as keyof typeof categories].services.map((service, index) => (
                                                <option key={index} value={service.name}>
                                                    {service.name} - {service.price}
                                                </option>
                                            ))}
                                        </select>
                                        {formData.service && (
                                            <div className="mt-3 p-4 bg-gray-700 rounded-lg border border-gray-600">
                                                <p className="text-sm text-gray-300">
                                                    {categories[formData.category as keyof typeof categories].services.find(
                                                        s => s.name === formData.service
                                                    )?.description}
                                                </p>
                                            </div>
                                        )}
                                    </div>
                                )}

                                <div>
                                    <label htmlFor="description" className="block text-sm font-medium text-gray-300">
                                        Descri√ß√£o do Projeto
                                    </label>
                                    <textarea
                                        name="description"
                                        id="description"
                                        rows={4}
                                        required
                                        value={formData.description}
                                        onChange={handleChange}
                                        className="mt-1 block w-full rounded-lg bg-gray-700 border-gray-600 text-white placeholder-gray-400 focus:border-red-500 focus:ring-red-500 transition-colors duration-200"
                                        placeholder="Descreva seu projeto ou necessidade..."
                                    />
                                </div>
                            </div>

                            <div className="flex items-start">
                                <input
                                    type="checkbox"
                                    id="acceptedTerm"
                                    checked={acceptedTerm}
                                    onChange={handleTermChange}
                                    className="mt-1 mr-2 rounded border-gray-400 focus:ring-red-500 focus:border-red-500"
                                    required
                                />
                                <label htmlFor="acceptedTerm" className="text-sm text-gray-300 select-none">
                                    Estou ciente de que manuten√ß√µes a longo prazo n√£o est√£o inclusas no valor do or√ßamento.
                                </label>
                            </div>

                            <div className="flex justify-center pt-4">
                                <button
                                    type="submit"
                                    className="w-full py-4 px-6 text-lg font-medium text-white bg-gradient-to-r from-red-600 to-red-700 rounded-lg hover:from-red-700 hover:to-red-800 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 transition-all duration-300 transform hover:scale-105 disabled:opacity-60"
                                    disabled={loading || !acceptedTerm}
                                >
                                    {loading ? 'Enviando...' : 'Enviar Solicita√ß√£o'}
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    );
};

export default Budget; 